(this.webpackJsonpTranslateBlog=this.webpackJsonpTranslateBlog||[]).push([[0],{182:function(t,e,n){},183:function(t,e,n){},184:function(t,e,n){},189:function(t,e){},213:function(t,e){},269:function(t,e,n){var a={"./amplify-amazon-button_5.entry.js":[292,16],"./amplify-auth-container.entry.js":[293,17],"./amplify-auth-fields_9.entry.js":[294,18],"./amplify-authenticator.entry.js":[295,5],"./amplify-button_3.entry.js":[296,19],"./amplify-chatbot.entry.js":[297,4],"./amplify-checkbox.entry.js":[298,20],"./amplify-confirm-sign-in_7.entry.js":[299,6],"./amplify-container.entry.js":[300,21],"./amplify-federated-buttons_2.entry.js":[301,22],"./amplify-federated-sign-in.entry.js":[302,23],"./amplify-form-field_4.entry.js":[303,24],"./amplify-greetings.entry.js":[304,25],"./amplify-icon-button.entry.js":[305,26],"./amplify-icon.entry.js":[306,7],"./amplify-link.entry.js":[307,27],"./amplify-nav_2.entry.js":[308,28],"./amplify-photo-picker.entry.js":[309,29],"./amplify-picker.entry.js":[310,30],"./amplify-radio-button_3.entry.js":[311,8],"./amplify-s3-album.entry.js":[312,9],"./amplify-s3-image-picker.entry.js":[313,10],"./amplify-s3-image.entry.js":[314,11],"./amplify-s3-text-picker.entry.js":[315,12],"./amplify-s3-text.entry.js":[316,13],"./amplify-select-mfa-type.entry.js":[317,31],"./amplify-sign-in-button.entry.js":[318,14],"./amplify-tooltip.entry.js":[319,32]};function o(t){if(!n.o(a,t))return Promise.resolve().then((function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}));var e=a[t],o=e[0];return n.e(e[1]).then((function(){return n(o)}))}o.keys=function(){return Object.keys(a)},o.id=269,t.exports=o},273:function(t,e,n){"use strict";n.r(e);var a=n(8),o=n.n(a),s=n(150),c=n.n(s),i=(n(182),n(33)),r=n(352);var l={aws_project_region:"us-east-1",aws_cognito_identity_pool_id:"us-east-1:883465e3-fd11-4feb-8827-49e649739974",aws_cognito_region:"us-east-1",aws_user_pools_id:"us-east-1_MNTlucal9",aws_user_pools_web_client_id:"5g8rsq4su5djeiuh9u3ueq4c82",oauth:{},aws_cognito_username_attributes:[],aws_cognito_social_providers:[],aws_cognito_signup_attributes:["EMAIL"],aws_cognito_mfa_configuration:"OFF",aws_cognito_mfa_types:["SMS"],aws_cognito_password_protection_settings:{passwordPolicyMinLength:8,passwordPolicyCharacters:[]},aws_cognito_verification_mechanisms:["EMAIL"]},u=(n(183),n(119),n(351)),d=n(63),g=n(264),f=(n(184),n(15));var p=t=>{let{chat:e,user:n}=t;return Object(f.jsxs)("li",{className:"chat ".concat(n===e.username?"right":"left"),children:[e.content,Object(f.jsx)("li",{className:"translatedMessage",children:e.translatedMessage})]})},h=n(60);var y=async function(t,e,n){return(await h.a.convert({translateText:{source:{text:t,language:e},targetLanguage:n}})).text},m=n(149);var j=async function(t,e,n,a){const o={body:{content:t,sourceLang:e,targetLang:n,terminologyNames:a},headers:{}};console.log("myInit :",o);try{var s=await m.a.post("amazonTranslateAPI","/translate",o);return console.log("ProcessChatTextAPI: ",s),s}catch(c){return console.error("ProcessChatTextAPI: ",c),c}},b=n(156);const{setGlobalState:C,useGlobalState:w}=Object(b.a)({languageTranslate:[],Chats:[],currentContactId:"none",languageOptions:{Afrikaans:"af",Albanian:"sq",Amharic:"am",Arabic:"ar",Armenian:"hy",Azerbaijani:"az",Bengali:"bn",Bosnian:"bs",Bulgarian:"bg",Catalan:"ca","Chinese (Simplified)":"zh","Chinese (Traditional)":"zh-TW",Croatian:"hr",Czech:"cs",Danish:"da",Dari:"fa-AF",Dutch:"nl",English:"en",Estonian:"et","Farsi (Persian)":"fa","Filipino Tagalog":"tl",Finnish:"fi",French:"fr","French (Canada)":"fr-CA",Georgian:"ka",German:"de",Greek:"el",Gujarati:"gu","Haitian Creole":"ht",Hausa:"ha",Hebrew:"he",Hindi:"hi",Hungarian:"hu",Icelandic:"is",Indonesian:"id",Italian:"it",Japanese:"ja",Kannada:"kn",Kazakh:"kk",Korean:"ko",Latvian:"lv",Lithuanian:"lt",Macedonian:"mk",Malay:"ms",Malayalam:"ml",Maltese:"mt",Mongolian:"mn",Norwegian:"no",Persian:"fa",Pashto:"ps",Polish:"pl",Portuguese:"pt",Romanian:"ro",Russian:"ru",Serbian:"sr",Sinhala:"si",Slovak:"sk",Slovenian:"sl",Somali:"so",Spanish:"es","Spanish (Mexico)":"es-MX",Swahili:"sw",Swedish:"sv",Tagalog:"tl",Tamil:"ta",Telugu:"te",Thai:"th",Turkish:"tr",Ukrainian:"uk",Urdu:"ur",Uzbek:"uz",Vietnamese:"vi",Welsh:"cy"}}),v=(t,e)=>{C("Chats",t)},_=t=>{C("languageTranslate",t)},O=t=>{C("currentContactId",t)};var I=t=>{const[e]=w("Chats"),n=w("currentContactId"),[o,s]=Object(a.useState)(""),[c]=w("languageTranslate"),[i]=w("languageOptions"),r="AGENT",l=Object(a.useRef)(null),u=Object(a.useRef)(null);return Object(a.useEffect)((()=>{l&&l.current.addEventListener("DOMNodeInserted",(t=>{const{currentTarget:e}=t;e.scroll({top:e.scrollHeight,behavior:"smooth"})})),u.current.focus()}),[]),Object(f.jsxs)("div",{className:"chatroom",children:[Object(f.jsxs)("h3",{children:["Translate - (",c.map((t=>{if(t.contactId===n[0])return t.lang})),") ",function(t){let e=c.find((t=>t.contactId===n[0]));return void 0===e?void 0:Object.keys(t).find((n=>t[n]===e.lang))}(i)]}),Object(f.jsx)("ul",{className:"chats",ref:l,children:e.map((t=>{if(t.contactId===n[0])return Object(f.jsx)(p,{chat:t,user:r})}))}),Object(f.jsxs)("form",{className:"input",onSubmit:async function(e){if(e.preventDefault(),""===o)return;let a=c.find((t=>t.contactId===n[0])),i=(await j(o,"en",a.lang,["connectChatTranslate"])).TranslatedText;console.log(" Original Message: "+o+"\n Translated Message: "+i);let l={contactId:n[0],username:r,content:Object(f.jsx)("p",{children:o}),translatedMessage:Object(f.jsx)("p",{children:i})};v((t=>[...t,l])),s(""),(async(t,e)=>{const n=await t.sendMessage({contentType:"text/plain",message:e}),{AbsoluteTime:a,Id:o}=n.data})(function(e){var n="";for(var a in t.session)for(var o in t.session[a])if(o===e){n=t.session[a][o];break}return n}(n[0]),i)},children:[Object(f.jsx)("input",{ref:u,maxLength:"1024",type:"text",value:o,onChange:t=>s(t.target.value)}),Object(f.jsx)("input",{type:"submit",value:"Submit"})]})]})};var x=async function(t){return h.a.interpret({text:{source:{text:t},type:"ALL"}})};d.default.configure(l),d.default.addPluggable(new g.a);var T=()=>{const[t]=w("languageTranslate");var e=[];const[n]=w("Chats"),[o,s]=Object(a.useState)(""),[c]=w("currentContactId"),[i]=w("languageOptions"),[r,l]=Object(a.useState)([]),[d]=Object(a.useState)([]);function g(n,a){n.getAgentConnection().getMediaController().then((n=>{n.onMessage((n=>{n.chatDetails.participantId===n.data.ParticipantId?console.log("CDEBUG ===> Agent ".concat(n.data.DisplayName," Says"),n.data.Content):(console.log("CDEBUG ===> Customer ".concat(n.data.DisplayName," Says"),n.data.Content),async function(n,a,o){let s="";for(var c=0;c<t.length;c++)if(t[c].contactId==o){s=t[c].lang;break}if(0==e.length||""==s){s=(await x(n)).textInterpretation.language}function i(t,e){const n=t.findIndex((t=>t.contactId===e.contactId));n>-1?t[n]=e:t.push(e)}i(t,{contactId:o,lang:s}),_(t);let r=await y(n,s,"en");console.log("CDEBUG ===>  Original Message: "+n+"\n Translated Message: "+r);let l={contactId:o,username:"customer",content:Object(f.jsx)("p",{children:n}),translatedMessage:Object(f.jsx)("p",{children:r})};v((t=>[...t,l]))}(n.data.Content,n.data.Type,n.data.ContactId))}))}))}function p(){window.connect.core.onViewContact((function(t){var e=t.contactId;console.log("CDEBUG ===> onViewContact",e),O(e)})),console.log("CDEBUG ===> subscribeConnectEvents"),window.connect.ChatSession?(console.log("CDEBUG ===> Subscribing to Connect Contact Events for chats"),window.connect.contact((n=>{n.onConnecting((()=>{console.log("CDEBUG ===> onConnecting() >> contactId: ",n.contactId);let t=n.getAttributes();console.log("CDEBUG ===> contactAttributes: ",JSON.stringify(t));let e=n.getQueue();console.log("CDEBUG ===> contactQueue: ",e)})),n.onAccepted((async()=>{console.log("CDEBUG ===> onAccepted: ",n);const a=n.getConnections().find((t=>t.getType()===window.connect.ConnectionType.AGENT)),o=await a.getMediaController();O(n.contactId),console.log("CDEBUG ===> agentChatSession ",o),l((t=>[...t,{[n.contactId]:o}])),e=n.getAttributes().x_lang.value,void 0!==Object.keys(i).find((t=>i[t]===e))&&(console.log("CDEBUG ===> Setting lang code from attribites:",e),t.push({contactId:n.contactId,lang:e}),_(t),d("updated")),console.log("CDEBUG ===> onAccepted, languageTranslate ",t)})),n.onConnected((async()=>{console.log("CDEBUG ===> onConnected() >> contactId: ",n.contactId);const t=n.getConnections().find((t=>t.getType()===window.connect.ConnectionType.AGENT));await t.getMediaController();g(n)})),n.onRefresh((()=>{console.log("CDEBUG ===> onRefresh() >> contactId: ",n.contactId)})),n.onEnded((()=>{console.log("CDEBUG ===> onEnded() >> contactId: ",n.contactId)})),n.onDestroy((()=>{console.log("CDEBUG ===> onDestroy() >> contactId: ",n.contactId),O("")}))})),console.log("CDEBUG ===> Subscribing to Connect Agent Events"),window.connect.agent((t=>{t.onStateChange((t=>{let e=t.newState;console.log("CDEBUG ===> New State: ",e)}))}))):(console.log("CDEBUG ===> waiting 3s"),setTimeout((function(){p()}),3e3))}return Object(a.useEffect)((()=>{window.connect.agentApp.initApp("ccp","ccp-container","https://realtimedemouci24.my.connect.aws/connect/ccp-v2/",{ccpParams:{region:"us-east-1",pageOptions:{enableAudioDeviceSettings:!0,enablePhoneTypeSettings:!0}}}),p()}),[]),Object(f.jsx)("main",{children:Object(f.jsx)(u.a,{columns:"equal",stackable:!0,padded:!0,children:Object(f.jsxs)(u.a.Row,{children:[Object(f.jsx)("div",{id:"ccp-container"}),Object(f.jsxs)("div",{id:"chatroom",children:[Object(f.jsx)(I,{session:r})," "]})]})})})};i.a.configure(l);class E extends a.Component{render(){return Object(f.jsx)("div",{className:"App",children:Object(f.jsx)(T,{})})}}var S=Object(r.a)(E);var D=t=>{t&&t instanceof Function&&n.e(35).then(n.bind(null,401)).then((e=>{let{getCLS:n,getFID:a,getFCP:o,getLCP:s,getTTFB:c}=e;n(t),a(t),o(t),s(t),c(t)}))};n(270),n(271);d.default.configure(l),c.a.render(Object(f.jsx)(o.a.StrictMode,{children:Object(f.jsx)(S,{})}),document.getElementById("root")),D()}},[[273,2,3]]]);
//# sourceMappingURL=main.6923c49c.chunk.js.map